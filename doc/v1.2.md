

## Version 1.2

### 本版本目标
&emsp;重构，提高健壮性，保证基本可用


### todo list


    1. 重构——RpcClientSession，之前写的其实不烂，但是设计之初想让client使用起来几乎无感，但是即使需要提前注册protobuf类型，也无所谓（也许更好）
    2. 新增——ProtocolFactory，就是为了解决上述问题，因为之前实现了自动解析，是依赖于模板。通过模板特例化出不同的async_call 和 rpcsession。这里的问题在于，不同协议，就需要一个rpcsession，如果服务多起来，那么一个客户端很可能达到几百条连接。实际上根据使用场景，比如登录，只存在一小会儿，建立长链接其实比较麻烦。不如一条长连接 + 对协议完全抽象（在我的rpc框架里面，只存在protoid+bytearray，完全不关心协议，类型转换交给使用者注册）
    3. 心跳包问题，重构RpcClientSession，顺带加一个超时计时器，问题不大。顺便实现单包超时问题。
    4. TODO——协程池，仔细思考一下，原本想着单线程协程可以完全无锁，但是发现完全达咩。因为需要同步的数据还是要加锁，比如注册时，需要一个线程安全的 buffer/map ，比如返回结果时，也需要一个线程安全的返回方式，所以没法从根本上解决问题，虽然减少了加锁，但是感觉复杂度剧增，带来的单线程阻塞问题难以解决。所以决定大改协程调度器，顺便优化一下命名，封装一个线程安全的协程池，这样注册协程更方便，也可以保留之前单线程协程的特色。
    5. TODO——是否保留以前的调用方式，感觉可以提供一个短连接的接口。
    6. yrpc::network，可以抽象、泛化，再特化一套proto专用的和http、https等。
    7. 命名空间调整，需要仔细梳理命名空间，已经有点影响开发效率，要不是作者只有一个人，肯定头疼的要死。
    8. 注释、命名、接口规范文档，想长期维护，需要有一个完善的文档。
    9. 注释、命名、接口、代码规范统一风格。还有protobuf，要慢慢想个好的解决方法
    10. 自动化脚本测试工具。
    11. 压测工具、压测脚本。
    12. bench。
    13. 线程安全的map、set等容器

<br>
<br>
<br>
<br>

### done list
    1. 基本完成。(9.24)
    2. 已完成 (9.22)
    13. 部分完成，并测试，线程安全。需要用到再封装。(9.24)